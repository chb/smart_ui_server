<html>
    <head>
        <link rel="stylesheet" href="../../jmvc/rhino/documentation/style.css" type="text/css" />
        <title>MVC.Model</title>
    </head>
    <body>
        <div id='left_side'><h3>Documentation</h3>

    
        
 
            <a href='../classes/Account.html' id='Account.html'>
                Account
            </a>
       
        
    
        
 
            <a href='../classes/HealthfeedController.html' id='HealthfeedController.html'>
                HealthfeedController
            </a>
       
        
    
        
 
            <a href='../classes/MainController.html' id='MainController.html'>
                MainController
            </a>
       
        
    
        
 
            <a href='../classes/Message.html' id='Message.html'>
                Message
            </a>
       
        
    
        
 
            <a href='../classes/MessagingController.html' id='MessagingController.html'>
                MessagingController
            </a>
       
        
    
        
 
            <a href='../classes/MVC.Class.html' id='MVC.Class.html'>
                MVC.Class
            </a>
       
        
    
        
 
            <a href='../classes/MVC.Controller.html' id='MVC.Controller.html'>
                <span class='matches_previous'>MVC.</span>Controller
            </a>
       
        
    
        
 
            <a href='../classes/MVC.Controller.Action.html' id='MVC.Controller.Action.html'>
                <span class='matches_previous'>MVC.Controller.</span>Action
            </a>
       
        
    
        
 
            <a href='../classes/MVC.Controller.Action.Event.html' id='MVC.Controller.Action.Event.html'>
                <span class='matches_previous'>MVC.Controller.Action.</span>Event
            </a>
       
        
    
        
 
            <a href='../classes/MVC.Controller.Action.Subscribe.html' id='MVC.Controller.Action.Subscribe.html'>
                <span class='matches_previous'>MVC.Controller.Action.</span>Subscribe
            </a>
       
        
    
        
 
            <a href='../classes/MVC.Controller.Params.html' id='MVC.Controller.Params.html'>
                <span class='matches_previous'>MVC.Controller.</span>Params
            </a>
       
        
    
        
 
            <a href='../classes/MVC.Delegator.html' id='MVC.Delegator.html'>
                <span class='matches_previous'>MVC.</span>Delegator
            </a>
       
        
    
        
 
            <a href='../classes/MVC.Element.html' id='MVC.Element.html'>
                <span class='matches_previous'>MVC.</span>Element
            </a>
       
        
    
        
 
            <a href='../classes/MVC.Event.html' id='MVC.Event.html'>
                <span class='matches_previous'>MVC.</span>Event
            </a>
       
        
    
        
 
            <a href='../classes/MVC.IO.html' id='MVC.IO.html'>
                <span class='matches_previous'>MVC.</span>IO
            </a>
       
        
    
        
 
            <a href='../classes/MVC.IO.Ajax.html' id='MVC.IO.Ajax.html'>
                <span class='matches_previous'>MVC.IO.</span>Ajax
            </a>
       
        
    
        
 
            <a href='../classes/MVC.Model.html' id='MVC.Model.html'>
                <span class='matches_previous'>MVC.</span>Model
            </a>
       
        
    
        
 
            <a href='../classes/MVC.Model.Ajax.html' id='MVC.Model.Ajax.html'>
                <span class='matches_previous'>MVC.Model.</span>Ajax
            </a>
       
        
    
        
 
            <a href='../classes/MVC.Model.XmlRest.html' id='MVC.Model.XmlRest.html'>
                <span class='matches_previous'>MVC.Model.</span>XmlRest
            </a>
       
        
    
        
 
            <a href='../classes/MVC.Native.html' id='MVC.Native.html'>
                <span class='matches_previous'>MVC.</span>Native
            </a>
       
        
    
        
 
            <a href='../classes/MVC.Native.Array.html' id='MVC.Native.Array.html'>
                <span class='matches_previous'>MVC.Native.</span>Array
            </a>
       
        
    
        
 
            <a href='../classes/MVC.Native.Date.html' id='MVC.Native.Date.html'>
                <span class='matches_previous'>MVC.Native.</span>Date
            </a>
       
        
    
        
 
            <a href='../classes/MVC.Native.Function.html' id='MVC.Native.Function.html'>
                <span class='matches_previous'>MVC.Native.</span>Function
            </a>
       
        
    
        
 
            <a href='../classes/MVC.Native.Number.html' id='MVC.Native.Number.html'>
                <span class='matches_previous'>MVC.Native.</span>Number
            </a>
       
        
    
        
 
            <a href='../classes/MVC.Native.Object.html' id='MVC.Native.Object.html'>
                <span class='matches_previous'>MVC.Native.</span>Object
            </a>
       
        
    
        
 
            <a href='../classes/MVC.Native.String.html' id='MVC.Native.String.html'>
                <span class='matches_previous'>MVC.Native.</span>String
            </a>
       
        
    
        
 
            <a href='../classes/MVC.Store.html' id='MVC.Store.html'>
                <span class='matches_previous'>MVC.</span>Store
            </a>
       
        
    
        
 
            <a href='../classes/MVC.Vector.html' id='MVC.Vector.html'>
                <span class='matches_previous'>MVC.</span>Vector
            </a>
       
        
    
        
 
            <a href='../classes/MVC.View.html' id='MVC.View.html'>
                <span class='matches_previous'>MVC.</span>View
            </a>
       
        
    
        
 
            <a href='../classes/MVC.View.Helpers.html' id='MVC.View.Helpers.html'>
                <span class='matches_previous'>MVC.View.</span>Helpers
            </a>
       
        
    
        
 
            <a href='../classes/OpenAjax.html' id='OpenAjax.html'>
                OpenAjax
            </a>
       
        
    
        
 
            <a href='../classes/PHA.html' id='PHA.html'>
                PHA
            </a>
       
        
    
        
 
            <a href='../classes/Record.html' id='Record.html'>
                Record
            </a>
       
        
    
        
 
            <a href='../classes/RecordController.html' id='RecordController.html'>
                RecordController
            </a>
       
        
    
</div>
        <div id='right_side'><div><h1>MVC.Model <label>API</label></h1>

<div id='shortcuts'><a href='#MVC.Model'>MVC.Model</a>, <a href='#MVC.Model.prototype'>prototype</a>, <a href='#MVC.Model.prototype._clear'>_clear</a>, <a href='#MVC.Model.prototype._setProperty'>_setProperty</a>, <a href='#MVC.Model.prototype.attributes'>attributes</a>, <a href='#MVC.Model.prototype.callback'>callback</a>, <a href='#MVC.Model.prototype.destroy'>destroy</a>, <a href='#MVC.Model.prototype.element'>element</a>, <a href='#MVC.Model.prototype.element_id'>element_id</a>, <a href='#MVC.Model.prototype.init'>init</a>, <a href='#MVC.Model.prototype.is_new_record'>is_new_record</a>, <a href='#MVC.Model.prototype.publish'>publish</a>, <a href='#MVC.Model.prototype.save'>save</a>, <a href='#MVC.Model.prototype.set_attributes'>set_attributes</a>, <a href='#MVC.Model.prototype.update_attributes'>update_attributes</a>, <a href='#MVC.Model.prototype.validate'>validate</a>, <a href='#MVC.Model.static'>static</a>, <a href='#MVC.Model.static._clean_callbacks'>_clean_callbacks</a>, <a href='#MVC.Model.static.add_attribute'>add_attribute</a>, <a href='#MVC.Model.static.callback'>callback</a>, <a href='#MVC.Model.static.create_as_existing'>create_as_existing</a>, <a href='#MVC.Model.static.create_many_as_existing'>create_many_as_existing</a>, <a href='#MVC.Model.static.element_id_to_id'>element_id_to_id</a>, <a href='#MVC.Model.static.find_by_element'>find_by_element</a>, <a href='#MVC.Model.static.id'>id</a>, <a href='#MVC.Model.static.init'>init</a>, <a href='#MVC.Model.static.namespace'>namespace</a>, <a href='#MVC.Model.static.publish'>publish</a></div>


    <div class='inherits'>Inherits: <b><a href='MVC.Class.html'>MVC.Class</a></b></div>


<div class='group'>Models wrap an application's data layer.  This is done in two ways:
 <ul>
     <li>Requesting data from and interacting with services</li>
     <li>Wrap service data with a domain-specific representation</li>
 </ul>
 A strong model layer keeps your code organized and maintainable, but it typically
 is the least developed part of the MVC architecture.  This guide introduces you
 to the basics of how a model should work.  Note that much of what it demonstrates could be 
 done easier with a different base Model class such as <a href='MVC.Model.Ajax.html'>Model.Ajax</a>.
 <h2>Services</h2>
 Your models should be the way you communicate with the server.  Instead of using 
 Ajax/XHR requests directly, perform those requests in a model.  <br/><br/> For example:
<pre><code class='javascript'>//instead of:
new Ajax('/tasks.json', {onComplete: find_tasks_next_week })
//do this:
Task.find('all', find_tasks_next_week)<br/><br/>//instead of
new Ajax('/tasks/'+id+'/complete.json',{onComplete: task_completed})
//do this:
task.complete(task_completed)</code></pre>Typically there are two types of services any application connects to:
<ul>
     <li>Group - operate on many instances.  Ex: getting all tasks for a user.</li>
     <li>Singular - operate on one instance. Ex: completing a task. </li>
</ul>
For these types of services, you will want to build them in slightly different ways.
<h3>Group Services</h3>
Group services that request data should look like the following:
<pre><code class='javascript'>Task = MVC.Model.extend('task',
{
  find : function(params, callback){
    new Ajax('/tasks.json', {onComplete: MVC.Function.bind(function(response){
        //get data into the right format for create_as_existing
        var data =  eval('('+json_string+')');     
        //call create_as_existing to create instances
        var instances = this.create_many_as_existing(data);
        //call back with data.
        callback(instances)
    }) })
  }
},
{})</code></pre>Note this function uses <a href='MVC.Model.html#MVC.Model.static.create_many_as_existing'>create_many_as_existing</a>
to create new instances.  By using create_many_as_existing, the model will also publish
<a href='OpenAjax.html'>OpenAjax.hub</a> messages that can be listed to by controllers.
<h3>Singular Service</h3>
Singular services that minipulate data might look like:
<pre><code class='javascript'>Task = MVC.Model.extend('task',
{},
{
  complete: function(callback){
    new Ajax('/tasks/'+this.id+'/complete.json', {onComplete: MVC.Function.bind(function(response){
        this.completed = true;
        callback(this)
        this.publish("completed")
    }) })
  }
})</code></pre><h2>Wrapping Data</h2>
Now that you have instances, you can wrap their data in useful ways.  This is done by adding
functions to the Model's prototype methods.  For example:
<pre><code class='javascript'>Task = MVC.Model.extend('task',
{},
{
  status : function(){
    return this.complete ? "COMPLETE" : "INCOMPLETE"
  }
})</code></pre><h3>P</h3>
 <ul>
     <li>Model.find_one(params, callbacks)</li>
     <li>Model.find_all(params, callbacks)</li>
     <li>Model.create(attributes, callbacks)</li>
     <li>Model.update(id, attributes, callbacks)</li>
     <li>Model.destroy(id, callbacks)</li>
 </ul><br/><br/> <h2>Using Stores</h2>
 Model keeps all instances of a class in a <a href='MVC.Store.html'>Store</a>.  Stores provide an easy way of
 looking up instances by id.  <br/><br/> <h2>Using OpenAjax</h2><br/><br/></div>

<div><h2>Static Methods</h2>
<div><div class='method'>
 
 
 <h3 id="MVC.Model.static._clean_callbacks">_clean_callbacks</h3>
 <pre class='signiture'><code>_clean_callbacks(callbacks) -> undefined</code></pre>
 <div class='real_comment'>Used for converting callbacks to to seperate failure and succcess
</div>
   
      <div class='param '>
          <label>callbacks</label>
          <code>{Object}</code> - 
     
      </div>
 

                
</div><div class='method'>
 
 
 <h3 id="MVC.Model.static.add_attribute">add_attribute</h3>
 <pre class='signiture'><code>add_attribute(property, type) -> undefined</code></pre>
 <div class='real_comment'>Adds an attribute to the list of attributes for this class.
</div>
   
      <div class='param '>
          <label>property</label>
          <code>{String}</code> - 
      </div>
   
      <div class='param '>
          <label>type</label>
          <code>{String}</code> - 
     
      </div>
 

                
</div><div class='method'>
 
 
 <h3 id="MVC.Model.static.callback">callback</h3>
 <pre class='signiture'><code>callback(fname) -> Function</code></pre>
 <div class='real_comment'>Creates a callback function that will call back the function on the static class.
 If other arguments are passed, they will be added before the parameters used to call the callback.
</div>
   
      <div class='param '>
          <label>fname</label>
          <code>{String}</code> - 
      </div>
 

 
     <div class='return'>
         <label>returns</label> 
         <code>{Function}</code> - a callback function useful for Ajax calls
     
     </div>
                
</div><div class='method'>
 
 
 <h3 id="MVC.Model.static.create_as_existing">create_as_existing</h3>
 <pre class='signiture'><code>create_as_existing(attributes) -> Model</code></pre>
 <div class='real_comment'>Used to create an existing object from attributes
</div>
   
      <div class='param '>
          <label>attributes</label>
          <code>{Object}</code> - 
      </div>
 

 
     <div class='return'>
         <label>returns</label> 
         <code>{Model}</code> - an instance of the model
     
     </div>
                
</div><div class='method'>
 
 
 <h3 id="MVC.Model.static.create_many_as_existing">create_many_as_existing</h3>
 <pre class='signiture'><code>create_many_as_existing(instances) -> Array</code></pre>
 <div class='real_comment'>Creates many instances
</div>
   
      <div class='param '>
          <label>instances</label>
          <code>{Object}</code> - 
      </div>
 

 
     <div class='return'>
         <label>returns</label> 
         <code>{Array}</code> - an array of instances of the model
     
     </div>
                
</div><div class='method'>
 
 
 <h3 id="MVC.Model.static.element_id_to_id">element_id_to_id</h3>
 <pre class='signiture'><code>element_id_to_id(element_id) -> String</code></pre>
 <div class='real_comment'>Takes an element ID like 'todo_5' and returns '5'
</div>
   
      <div class='param '>
          <label>element_id</label>
          <code>{Object}</code> - 
      </div>
 

 
     <div class='return'>
         <label>returns</label> 
         <code>{String}</code> - 
     
     </div>
                
</div><div class='method'>
 
 
 <h3 id="MVC.Model.static.find_by_element">find_by_element</h3>
 <pre class='signiture'><code>find_by_element(el) -> undefined</code></pre>
 <div class='real_comment'>Returns an instance if one can be found in the store.
</div>
   
      <div class='param '>
          <label>el</label>
          <code>{Object}</code> - 
     
      </div>
 

                
</div><div class='attribute' id="MVC.Model.static.id"><h3>id</h3><p>The name of the id field.  Defaults to 'id'
     
</p></div><div class='method'>
 
 
 <h3 id="MVC.Model.static.init">init</h3>
 <pre class='signiture'><code>init(id, params, callbacks) -> Model</code></pre>
 <div class='real_comment'>Finds objects in this class
</div>
   
      <div class='param '>
          <label>id</label>
          <code>{Object}</code> - the id of a object
      </div>
   
      <div class='param '>
          <label>params</label>
          <code>{Object}</code> - params passed to the 
      </div>
   
      <div class='param '>
          <label>callbacks</label>
          <code>{Object}</code> - a single onComplete callback or a hash of callbacks
      </div>
 

 
     <div class='return'>
         <label>returns</label> 
         <code>{Model}</code> - will return instances of the model if syncronous
     
     </div>
                
</div><div class='attribute' id="MVC.Model.static.namespace"><h3>namespace</h3><p>Namespaces are used to publish messages to a specific namespace.
 @code_start
 Org.Task = MVC.Model.extend('task',{
   namespace: "org"
 },
 {
   update: function(){
     this.publish("update") // publishes 'this' to 'org.task.update'
   }
 })
 @code_end
     
</p></div><div class='method'>
 
 
 <h3 id="MVC.Model.static.publish">publish</h3>
 <pre class='signiture'><code>publish(event, data) -> undefined</code></pre>
 <div class='real_comment'>Publishes to open ajax hub.  Always adds the className.event
</div>
   
      <div class='param '>
          <label>event</label>
          <code>{Object}</code> - 
      </div>
   
      <div class='param '>
          <label>data</label>
          <code>{Object}</code> - 
     
      </div>
 

                
</div></div><h2>Prototype Methods</h2>
<div><div class='method'>
 
 
 <h3 id="MVC.Model.prototype._clear">_clear</h3>
 <pre class='signiture'><code>_clear() -> undefined</code></pre>
 <div class='real_comment'>for (var attr in attributes){
    		if(attributes.hasOwnProperty(attr)){
    			this._setAttribute(attr, attributes[attr]);
    		}
    	}
</div>
 

                
</div><div class='method'>
 
 
 <h3 id="MVC.Model.prototype._setProperty">_setProperty</h3>
 <pre class='signiture'><code>_setProperty(property, value) -> undefined</code></pre>
 <div class='real_comment'>Checks if there is a set_<i>property</i> value.  If it returns true, lets it handle; otherwise
 saves it.
</div>
   
      <div class='param '>
          <label>property</label>
          <code>{Object}</code> - 
      </div>
   
      <div class='param '>
          <label>value</label>
          <code>{Object}</code> - 
     
      </div>
 

                
</div><div class='method'>
 
 
 <h3 id="MVC.Model.prototype.attributes">attributes</h3>
 <pre class='signiture'><code>attributes() -> Object</code></pre>
 <div class='real_comment'>Returns a list of attribues.
</div>
 

 
     <div class='return'>
         <label>returns</label> 
         <code>{Object}</code> - 
     
     </div>
                
</div><div class='method'>
 
 
 <h3 id="MVC.Model.prototype.callback">callback</h3>
 <pre class='signiture'><code>callback(fname) -> Function</code></pre>
 <div class='real_comment'>Creates a callback function that will call back the function on the instance.
 If other arguments are passed, they will be added before the parameters used to call the callback.
</div>
   
      <div class='param '>
          <label>fname</label>
          <code>{String}</code> - 
      </div>
 

 
     <div class='return'>
         <label>returns</label> 
         <code>{Function}</code> - a callback function useful for Ajax calls
     
     </div>
                
</div><div class='method'>
 
 
 <h3 id="MVC.Model.prototype.destroy">destroy</h3>
 <pre class='signiture'><code>destroy(callback) -> undefined</code></pre>
 <div class='real_comment'>Destroys the instance
</div>
   
      <div class='param optional'>
          <label>callback</label>
          <code>{Function}</code> - or object of callbacks
     
      </div>
 

                
</div><div class='method'>
 
 
 <h3 id="MVC.Model.prototype.element">element</h3>
 <pre class='signiture'><code>element() -> undefined</code></pre>
 <div class='real_comment'>Returns the element found by using element_id for this instance
     
</div>
 

                
</div><div class='method'>
 
 
 <h3 id="MVC.Model.prototype.element_id">element_id</h3>
 <pre class='signiture'><code>element_id() -> undefined</code></pre>
 <div class='real_comment'>Returns the suggested element id for this instance
     
</div>
 

                
</div><div class='method'>
 
 
 <h3 id="MVC.Model.prototype.init">init</h3>
 <pre class='signiture'><code>init(attributes) -> undefined</code></pre>
 <div class='real_comment'>Creates, but does not save a new instance of this class
</div>
   
      <div class='param '>
          <label>attributes</label>
          <code>{Object}</code> - -> a hash of attributes
     
      </div>
 

                
</div><div class='method'>
 
 
 <h3 id="MVC.Model.prototype.is_new_record">is_new_record</h3>
 <pre class='signiture'><code>is_new_record() -> undefined</code></pre>
 <div class='real_comment'>Returns if the instance is a new object
     
</div>
 

                
</div><div class='method'>
 
 
 <h3 id="MVC.Model.prototype.publish">publish</h3>
 <pre class='signiture'><code>publish(event, data) -> undefined</code></pre>
 <div class='real_comment'>Publishes to open ajax hub
</div>
   
      <div class='param '>
          <label>event</label>
          <code>{String}</code> - 
      </div>
   
      <div class='param optional'>
          <label>data</label>
          <code>{Object}</code> - if missing, uses the instance in {data: this}
     
      </div>
 

                
</div><div class='method'>
 
 
 <h3 id="MVC.Model.prototype.save">save</h3>
 <pre class='signiture'><code>save(callbacks) -> undefined</code></pre>
 <div class='real_comment'>Saves the instance
</div>
   
      <div class='param optional'>
          <label>callbacks</label>
          <code>{Function}</code> - onComplete function or object of callbacks
     
      </div>
 

                
</div><div class='method'>
 
 
 <h3 id="MVC.Model.prototype.set_attributes">set_attributes</h3>
 <pre class='signiture'><code>set_attributes(attributes) -> undefined</code></pre>
 <div class='real_comment'>Sets a hash of attributes for this instance
</div>
   
      <div class='param '>
          <label>attributes</label>
          <code>{Object}</code> - 
     
      </div>
 

                
</div><div class='method'>
 
 
 <h3 id="MVC.Model.prototype.update_attributes">update_attributes</h3>
 <pre class='signiture'><code>update_attributes(attributes, callback) -> undefined</code></pre>
 <div class='real_comment'>Sets the attributes on this instance and calls save.
</div>
   
      <div class='param '>
          <label>attributes</label>
          <code>{Object}</code> - 
      </div>
   
      <div class='param '>
          <label>callback</label>
          <code>{Object}</code> - 
     
      </div>
 

                
</div><div class='method'>
 
 
 <h3 id="MVC.Model.prototype.validate">validate</h3>
 <pre class='signiture'><code>validate() -> undefined</code></pre>
 <div class='real_comment'>Validates this instance
     
</div>
 

                
</div></div></div>
</div></div>
        <script type="text/javascript" src="../../jmvc/rhino/documentation/highlight/highlight.js"></script>
        <script type="text/javascript">
          hljs.initHighlightingOnLoad('html', 'css','javascript');
        </script>
        <script type="text/javascript">
            //select someone
            parts = window.location.href.split("/")
            var selected = document.getElementById(parts.pop().replace(/[#|?].*/,""))
            if(selected){
                selected.className = "selected";
            }
        </script>
    </body>
</html>